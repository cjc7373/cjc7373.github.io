<!doctype html><html><head><title>Hello, Hugo!</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content="3MbbliKSwhNvv713tGB2RL8xvrJC404x1BFONabsw7g"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><script src=/js/toc.js></script>
<link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.7c01e9f6fb2f6083d79d2f3a32ec6b7901e262e94a52a64a542aef98bc5bda64.css integrity="sha256-fAHp9vsvYIPXnS86MuxreQHiYulKUqZKVCrvmLxb2mQ=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Material+Icons"><script async defer data-domain=blog.coherence.codes src=https://analytics.coherence.space/js/plausible.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></head><body><div id=app><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>存档</a>
<a class="a-block drawer-menu-item false" href=/tags>标签</a>
<a class="a-block drawer-menu-item false" href=/categories>分类</a>
<a class="a-block drawer-menu-item false" href=/about>关于</a>
<a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a><div class=toc><div class=toc-content><center>- 目录 -</center><ul><ul><li><a href=#%e5%8e%86%e5%8f%b2 class=nav-历史>历史</a></li><li><a href=#%e5%85%b3%e4%ba%8e%e5%8d%9a%e5%ae%a2 class=nav-关于博客>关于博客</a></li><li><a href=#%e8%bf%81%e7%a7%bb class=nav-迁移>迁移</a></li><li><a href=#%e9%83%a8%e7%bd%b2 class=nav-部署>部署</a></li><li><a href=#todo class=nav-todo>TODO</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://blog.coherence.codes/>Coherence's Blog</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://blog.coherence.codes/><div class=single-column-header-title>Coherence's Blog</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>Hello, Hugo!<div class=post-meta><time itemprop=datePublished>2022-10-02 00:00</time>
<i class=material-icons>label</i>
<a href=/tags/blog>blog</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><p>这是一个船新的博客！</p><h2 id=历史>历史</h2><p>在大二（2018）的时候，我萌生了搭建一个自己的独立博客的想法，于是就有了 <a href=/posts/2020_and_before/hexo%E6%90%AD%E5%BB%BA%E5%B0%8F%E8%AE%B0/>hexo搭建小记</a>，当时我随手一找找到的基本都是 Hexo，于是我就用了。引用一段当时写的关于页面：</p><blockquote><h2 id=关于博客>关于博客</h2><ul><li>2021-02-08 迁移到 pelican, 打算自己写个主题, 待填坑</li><li>2020-03-26 更新 Hexo 至 4.2.0，启用 hexo-generator-sitemap 插件</li><li>2020-02-22 更改评论为 <code>disqusjs</code>，详见作者的<a href=https://blog.skk.moe/post/disqusjs/>博文</a>；启用 <a href=https://github.com/theme-next/theme-next-pjax>pjax</a></li><li>2019-12-24 启用新域名<code>blog.coherence.codes</code></li><li>2019-10-07 升级主题至 Next V7.4.1</li><li>2018-09-24 第一篇博文。采用 Hexo + NexT 主题， 部署于 Github Pages。搭建过程见{% post_link Hexo搭建小记 这篇文章 %}</li></ul></blockquote><p>Next 就是一个非常大众的主题，有几种变体，我用的是一个叫 <code>pisces</code> 的变体，长这样（原博客图已经找不到了，只能用官方 Demo 凑数了）：</p><p><img src=image-20221002165030564.png alt=image-20221002165030564></p><p>这一时期的博客位于 <a href=https://github.com/cjc7373/cjc7373.github.io/tree/source/source>source 分支</a>，最后更新于 2020-04-16。</p><p>由于这个主题实在是太大众了，中途（2019-10 左右）我也想过换一个主题（<a href=https://github.com/yscoder/hexo-theme-indigo>hexo-theme-indigo</a>，一个 Material Design 风格的主题），但是没有配置成功，<a href=https://github.com/cjc7373/cjc7373.github.io/tree/theme-indigo>theme-indigo 分支</a>便是那次尝试。theme-indigo 的效果图长这样：</p><p><img src=image-20221002165819783.png alt=image-20221002165819783></p><p>到了 21 年 2 月，我开始重新调研博客生成器，当时看到了一个 Python 写的 Pelican，而我又希望壮大一下 Python 生态，于是就用了。用了之后发现并没有什么合适的主题，恰巧 Pelican 用的模板引擎 Jinja 和 Django Template Engine 很像，我比较熟悉，于是我就想自己写一个主题，然而这一工作从没开始过.. 于是我现在的博客是这样的（<del>极简主义</del>）：</p><p><img src=image-20221002171314620.png alt=image-20221002171314620></p><p>这段时间里我还写过一个<a href=https://github.com/cjc7373/pelican-markdown-image>处理图片的 Pelican 插件</a>，虽然现在看起来挺蠢的..</p><p>再后来，我又对 Rust 产生了兴趣，于是又发现了 Zola，这时候我找到了 <a href=https://github.com/AmazingRise/hugo-theme-diary>hugo-theme-diary</a> 这个主题，感觉非常不错，于是就想把它移植到 zola，在 port 了一个 head 之后，这个计划就被无限期搁置了。</p><p>终于，我感觉还是有必要有一个好看的博客的，于是我最终选择了 Hugo+hugo-theme-diary，加上一点点自己的魔改。</p><h2 id=迁移>迁移</h2><p>Hugo 对于资源文件的处理有<a href=https://gohugo.io/content-management/image-processing/>自己的一套规则</a>，即博客文章位于 <code>posts/post_name/index.md</code>，这篇文章资源文件放在 <code>posts/post_name/</code> 这个路径下面。而我原来的文件结构为文章位于 <code>posts/post_name.md</code>，资源文件位于 <code>posts/post_name/</code>。所以我不得不写了一个脚本来迁移图片：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>md_image <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>compile(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;!\[(.*)\]\((.*)\)&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>replace_image_reference_in_a_md_file</span>(md, dry_run<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(md, <span style=color:#e6db74>&#34;r&#34;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf8&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>replace</span>(match):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        match[0]: all matched string
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        match[1]: name
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        match[2]: image path
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        rep <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;![</span><span style=color:#e6db74>{</span>match[<span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>](./</span><span style=color:#e6db74>{</span>match[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Replacing </span><span style=color:#e6db74>{</span>match[<span style=color:#ae81ff>0</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74> with </span><span style=color:#e6db74>{</span>rep<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> rep
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> md_image<span style=color:#f92672>.</span>sub(replace, content)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> dry_run:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(md, <span style=color:#e6db74>&#34;w&#34;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf8&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>            f<span style=color:#f92672>.</span>write(content)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>to_mig: list[Path] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>working_dir <span style=color:#f92672>=</span> Path(<span style=color:#e6db74>&#34;./2022&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> working_dir<span style=color:#f92672>.</span>iterdir():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> f<span style=color:#f92672>.</span>suffix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;.md&#34;</span>:
</span></span><span style=display:flex><span>        to_mig<span style=color:#f92672>.</span>append(f)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(to_mig)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> to_mig:
</span></span><span style=display:flex><span>    replace_image_reference_in_a_md_file(f)
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>rename(working_dir <span style=color:#f92672>/</span> Path(f<span style=color:#f92672>.</span>stem) <span style=color:#f92672>/</span> <span style=color:#e6db74>&#34;index.md&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(f&#34;Move {f} to {Path(f.stem) / &#39;index.md&#39;}&#34;)</span>
</span></span></code></pre></div><p>Hugo 用的模板引擎是 Go 标准库里的，这点好评，Helm 用的同样是这个模板引擎。</p><h2 id=部署>部署</h2><p>现在的部署简单好多啊，只需一个配置文件，Github Actions 因为是自家产品的缘故连 token 都不需要了，自定义域名 CNAME 也只需在配置文件中增加一行，相比于三年之前的部署体验真的是天差地别..</p><h2 id=todo>TODO</h2><ul><li><p>Hugo 处理页面之间链接也有<a href=https://gohugo.io/content-management/cross-references/>自己的规则</a>，目前好多跨页面链接是坏的</p></li><li><p>代码高亮的配色非常诡异..</p><p><img src=image-20221003005014257.png alt=image-20221003005014257></p><p>发现在本地的配色是正常的，检查发现本地是 Hugo extended version，于是在 actions 中也启用了 extended 后恢复正常，挺奇怪的..</p></li></ul><hr width=100% id=EOF><p style=color:#777>最后修改于 2022-10-02</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2023/ipv6-%E5%85%A5%E9%97%A8/>下回<br>IPv6 配置入门</a>
<a class=older-posts href=/posts/2022/the-2022-python-language-summit/>上回<br>The 2022 Python Language Summit</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://blog.coherence.codes/><div class=nav-title>Coherence's Blog</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>存档</a>
<a class="a-block nav-link-item false" href=/tags>标签</a>
<a class="a-block nav-link-item false" href=/categories>分类</a>
<a class="a-block nav-link-item false" href=/about>关于</a>
<a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a></div><div class=nav-footer><a href=https://github.com/cjc7373/hugo-theme-diary>Modified</a> Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Coherence. 本站遵循 CC BY-NC-SA 4.0 协议</div></div><div id=extraContainer class=extra-container><div class=toc-wrapper><div class=toc><div class=toc-content><center>- 目录 -</center><ul><ul><li><a href=#%e5%8e%86%e5%8f%b2 class=nav-历史>历史</a></li><li><a href=#%e5%85%b3%e4%ba%8e%e5%8d%9a%e5%ae%a2 class=nav-关于博客>关于博客</a></li><li><a href=#%e8%bf%81%e7%a7%bb class=nav-迁移>迁移</a></li><li><a href=#%e9%83%a8%e7%bd%b2 class=nav-部署>部署</a></li><li><a href=#todo class=nav-todo>TODO</a></li></ul></div></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div id=single-column-footer><a href=https://github.com/cjc7373/hugo-theme-diary>Modified</a> Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Coherence. 本站遵循 CC BY-NC-SA 4.0 协议</div></div><script src=/js/journal.js></script></body></html>