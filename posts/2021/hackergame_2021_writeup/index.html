<!doctype html><html><head><title>Hackergame 2021 write-up</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content="3MbbliKSwhNvv713tGB2RL8xvrJC404x1BFONabsw7g"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><script src=/js/toc.js></script>
<link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.7c01e9f6fb2f6083d79d2f3a32ec6b7901e262e94a52a64a542aef98bc5bda64.css integrity="sha256-fAHp9vsvYIPXnS86MuxreQHiYulKUqZKVCrvmLxb2mQ=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Material+Icons"><script async defer data-domain=blog.coherence.codes src=https://analytics.coherence.space/js/plausible.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></head><body><div id=app><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>存档</a>
<a class="a-block drawer-menu-item false" href=/tags>标签</a>
<a class="a-block drawer-menu-item false" href=/categories>分类</a>
<a class="a-block drawer-menu-item false" href=/about>关于</a>
<a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a><div class=toc><div class=toc-content><center>- 目录 -</center><ul><ul><li><a href=#%e7%ad%be%e5%88%b0 class=nav-签到>签到</a></li><li><a href=#%e8%bf%9b%e5%88%b6%e5%8d%81%e5%85%ad%e5%8f%82%e4%b8%8a class=nav-进制十六参上>进制十六——参上</a></li><li><a href=#%e5%8e%bb%e5%90%a7%e8%bf%bd%e5%af%bb%e8%87%aa%e7%94%b1%e7%9a%84%e7%94%b5%e6%b3%a2 class=nav-去吧追寻自由的电波>去吧！追寻自由的电波</a></li><li><a href=#%e7%8c%ab%e5%92%aa%e9%97%ae%e7%ad%94-pro-max class=nav-猫咪问答-pro-max>猫咪问答 Pro Max</a></li><li><a href=#%e5%8d%96%e7%93%9c class=nav-卖瓜>卖瓜</a></li><li><a href=#%e9%80%8f%e6%98%8e%e7%9a%84%e6%96%87%e4%bb%b6 class=nav-透明的文件>透明的文件</a></li><li><a href=#%e6%97%85%e8%a1%8c%e7%85%a7%e7%89%87 class=nav-旅行照片>旅行照片</a></li><li><a href=#flag-%e5%8a%a9%e5%8a%9b%e5%a4%a7%e7%ba%a2%e5%8c%85 class=nav-flag-助力大红包>FLAG 助力大红包</a></li><li><a href=#amnesia class=nav-amnesia>Amnesia</a></li><li><a href=#%e5%9b%be%e4%b9%8b%e4%b8%8a%e7%9a%84%e4%bf%a1%e6%81%af class=nav-图之上的信息>图之上的信息</a></li><li><a href=#easy-rsa class=nav-easy-rsa>Easy RSA</a></li><li><a href=#%e5%8a%a0%e5%af%86%e7%9a%84-u-%e7%9b%98 class=nav-加密的-u-盘>加密的 U 盘</a></li><li><a href=#%e8%b5%9b%e5%8d%9a%e5%8e%a8%e6%88%bf class=nav-赛博厨房>赛博厨房</a></li><li><a href=#%e9%98%b5%e5%88%97%e6%81%a2%e5%a4%8d%e5%a4%a7%e5%b8%88 class=nav-阵列恢复大师>阵列恢复大师</a></li><li><a href=#%e9%a9%ac%e8%b5%9b%e5%85%8b class=nav-马赛克>马赛克</a></li><li><a href=#minecraft class=nav-minecraft>minecRaft</a></li><li><a href=#%e5%85%b6%e4%bb%96 class=nav-其他>其他</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://blog.coherence.codes/>Coherence's Blog</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://blog.coherence.codes/><div class=single-column-header-title>Coherence's Blog</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>Hackergame 2021 write-up<div class=post-meta><time itemprop=datePublished>2021-10-30 00:00</time></div></div></div><div class=post-body-wrapper><div class=post-body v-pre><p>记录一下比赛期间踩到的坑.</p><h2 id=签到>签到</h2><p>开始完全没有读题直接进题目, 然后想了半天没思路并随机测试了一些数.. 直到我读了题..</p><h2 id=进制十六参上>进制十六——参上</h2><p>显然, 大家都知道怎么编辑十六进制, 然而我并不想手输这么多文本, 于是 Google 在线 OCR, 结果 OCR 的内容有部分是错的.. 被迫找同学要了一份 OCR 结果.</p><h2 id=去吧追寻自由的电波>去吧！追寻自由的电波</h2><p>直接 Google ffmepg 音频速度. 然而很多结果给的一个过滤器是不改变音调的方案, 后来发现直接改采样率就行了..</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>cjc@coherence hackergame_2021<span style=color:#f92672>]</span>$ file radio.mp3 
</span></span><span style=display:flex><span>radio.mp3: Audio file with ID3 version 2.4.0, contains: MPEG ADTS, layer III, v1, <span style=color:#ae81ff>128</span> kbps, <span style=color:#ae81ff>48</span> kHz, Stereo
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>cjc@coherence hackergame_2021<span style=color:#f92672>]</span>$ ffmpeg -i radio.mp3 -af <span style=color:#e6db74>&#34;asetrate=16000&#34;</span> radio_output.mp3
</span></span></code></pre></div><p>命令来自<a href=http://johnriselvato.com/ffmpeg-how-to-change-the-pitch-sample-rate-of-an-audio-track-mp3/>这里</a>, 虽然我根本没有看这篇文章..</p><h2 id=猫咪问答-pro-max>猫咪问答 Pro Max</h2><p>没错, 被第二题坑了.. 以为是第四题不对, 于是写了个暴力跑了几万次..</p><p><img src=./image-20211030151026284.png alt=image-20211030151026284></p><p>提示: 这是一个提示.</p><h2 id=卖瓜>卖瓜</h2><p>已经被同学提示了这是个 PHP 溢出问题.. 甚至都找到了 (同学给的) <a href=https://www.php.net/manual/zh/language.types.integer.php#125251>PHP 文档中的一条评论 (甚至题解也给了这个)</a>, 但是并不知道怎么做.. 于是用 <code>b1=2**63//6+n</code> (n 为 -10~10 之间的一个随机数) 瞎试做出来了.</p><h2 id=透明的文件>透明的文件</h2><p>看<a href=https://learnku.com/articles/26231>这篇文章</a>学到了一些 ANSI 转义序列的知识. 题解上说只需简单地在 <code>[</code> 前加上 <code>\x1b</code> 就行, 然而并不行.. 我的终端并不能解析这些转义序列..</p><p><img src=./image-20211030153759137.png alt=image-20211030153759137></p><p>于是在进行了一些我也忘记了是什么的操作之后终于成功了:</p><p><img src=./image-20211030154033261.png alt=image-20211030154033261></p><p>只记得 Python 从文件读然后 print 和直接 print 一个字符串的结果还不一样.. (也可能是是否在 REPL 下的区别.. 不管了)</p><p>找个时间可以好好学一学这方面的内容..</p><p>PS: 直接使用 <code>cat transparent.txt | sed 's/\[/\x1b[/g' | sed 's/ /#/g'</code> 是可以的.. 那看来是 VSCode 的替换的锅了.. 在 VSCode 中我直接用字符串 <code>\x1b</code> 替换的.. 而 sed 替换出来的是一个字节 <code>\x1b</code>..</p><h2 id=旅行照片>旅行照片</h2><p>纯社工题. 第五题题解中说的百度街景里并没有找到.. 小红书发挥了重要作用..</p><h2 id=flag-助力大红包>FLAG 助力大红包</h2><p>居然真的有人在求助力..</p><p><img src=./image-20211030154537778.png alt=image-20211030154537778></p><p>第一时间就想到了 <code>X-Forwarded-For</code>. 我以为并不会这么简单, 没想到恰恰是这么简单..</p><p>这题因为题目的请求并发限制还被坑了一会..</p><h2 id=amnesia>Amnesia</h2><p>没想到题解这么简单, <code>putchar</code> 一个 char 字符会被分配到栈上, 我还用了一个很魔法的方法..</p><p><img src=./image-20211030164358742.png alt=image-20211030164358742></p><p>这样似乎能强制把 b 数组放到 .text 段上..</p><p>第二问显然我不会..</p><h2 id=图之上的信息>图之上的信息</h2><p>基本没遇到什么障碍, Google 到 <a href=https://stackoverflow.com/questions/34199982/how-to-query-all-the-graphql-type-fields-without-writing-a-long-query>How to query all the GraphQL type fields without writing a long query?</a> 之后试了几分钟就试出来了.</p><h2 id=easy-rsa>Easy RSA</h2><p>get_p 用一下 <a href=https://en.wikipedia.org/wiki/Wilson%27s_theorem>Wilson&rsquo;s theorem</a> 就行, 但 get_q 直到比赛结束还没想出来.. 还是数理基础不够扎实(</p><p>原来 get_q 也是一次 RSA 的加密过程! 我还一直在试图解 $value_q = q^e mod\ n$ 这个方程.. (能解出来就有鬼了)</p><p>那么现在虽然我还不懂 RSA 的正确性, <del>我已经完全掌握 RSA 了</del>.</p><h2 id=加密的-u-盘>加密的 U 盘</h2><p>一开始各种 Google <code>luks exploit</code>, <code>luks attack</code>, 但是总感觉这么一个应用广泛的标准有明显的漏洞不太可能.. 直到我读了一下 <code>man cryptsetup</code>..</p><p><img src=./image-20211030160044184.png alt=image-20211030160044184></p><p>从题解中我得知了 LUKS 使用 passphrase 用来加密 master key, master key 加密全盘文件, 这是为了避免改 passphrase 时重新加密全盘的开销.</p><h2 id=赛博厨房>赛博厨房</h2><p>Level 0 和 1 很简单.</p><p>从同学处得到的提示每日菜谱是根据哈希来的, 于是写了个暴力, 然而跑了几个小时都没跑出结果..</p><p><img src=./image-20211030175312389.png alt=image-20211030175312389></p><p>题解确实是暴力.. 但是我这样枚举是不对的, 因为菜谱是哈希, 所以只要稍微改一点点程序就能得到一个不一样的菜谱, 然后赌哈希的结果.. (相当于工作量证明了..)</p><p>Level 3 显然看都没看..</p><h2 id=阵列恢复大师>阵列恢复大师</h2><p>尝试暴力了一下磁盘顺序, 看了题解发现离正确答案还有很远.. 比如 chunk 的大小, 文件系统类型 (这两个我想到了, 但不知道怎么获得), <code>mdadm --build</code> 和 <code>mdadm --create</code> 的区别..</p><p><img src=./image-20211030175155176.png alt=image-20211030175155176></p><h2 id=马赛克>马赛克</h2><p>尝试了一下最后只把定位点给恢复出来了.. 题解的思路是暴力枚举, 思路确实很简单, 难的是实现..</p><h2 id=minecraft>minecRaft</h2><p>扫了一遍源码发现核心逻辑应该是在 flag.js 中. 打开一看经典混淆了.. 操作了一番 (指替换变量名) 后尝试把 <code>gyflagh</code> 函数的返回改成 <code>true</code>, 发现并没有用. 那看来是要解密那个字符串了..</p><p><img src=./image-20211030161245519.png alt=image-20211030161245519></p><p>核心逻辑在 code 函数里:</p><p><img src=./image-20211030161353309.png alt=image-20211030161353309></p><p>本以为这个过程是不可逆的, 但最后一天仔细看了一下后发现第 68 行 array_a[0] 的操作中只涉及了 array_a[1], 第 71 行也是同理, 于是只要简单地减一下就行了.</p><p><img src=./image-20211030161717407.png alt=image-20211030161717407></p><p>还好几个辅助函数比如 <code>LongToBase16</code>, <code>Base16ToLong</code> 没有混淆.. 不然肯定做不出了..</p><h2 id=其他>其他</h2><ul><li><p>震惊! 排行榜上有选手公然发题解!</p><p><img src=./image-20211030145149135.png alt=image-20211030145149135></p><p>嗯.. 看昵称就知道是什么了..</p></li><li><p>最后校内排名 29, 总排名推测一下应该在 100~200 之间</p><p><img src=./image-20211030165413748.png alt=image-20211030165413748></p><p>全靠 web 和 general 拿分..</p></li><li><p>不过在第一天甚至短暂地冲到过第一, 人生巅峰.jpg</p><p><img src=./image-20211030165521990.png alt=image-20211030165521990></p></li></ul><hr width=100% id=EOF><p style=color:#777>最后修改于 2021-10-30</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2021/my_first_archlinux_package/>下回<br>我的第一个 Archlinux 包</a>
<a class=older-posts href=/posts/2021/2020summary_2021plan/>上回<br>2020年终总结&2021展望</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://blog.coherence.codes/><div class=nav-title>Coherence's Blog</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>存档</a>
<a class="a-block nav-link-item false" href=/tags>标签</a>
<a class="a-block nav-link-item false" href=/categories>分类</a>
<a class="a-block nav-link-item false" href=/about>关于</a>
<a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a></div><div class=nav-footer><a href=https://github.com/cjc7373/hugo-theme-diary>Modified</a> Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Coherence. 本站遵循 CC BY-NC-SA 4.0 协议</div></div><div id=extraContainer class=extra-container><div class=toc-wrapper><div class=toc><div class=toc-content><center>- 目录 -</center><ul><ul><li><a href=#%e7%ad%be%e5%88%b0 class=nav-签到>签到</a></li><li><a href=#%e8%bf%9b%e5%88%b6%e5%8d%81%e5%85%ad%e5%8f%82%e4%b8%8a class=nav-进制十六参上>进制十六——参上</a></li><li><a href=#%e5%8e%bb%e5%90%a7%e8%bf%bd%e5%af%bb%e8%87%aa%e7%94%b1%e7%9a%84%e7%94%b5%e6%b3%a2 class=nav-去吧追寻自由的电波>去吧！追寻自由的电波</a></li><li><a href=#%e7%8c%ab%e5%92%aa%e9%97%ae%e7%ad%94-pro-max class=nav-猫咪问答-pro-max>猫咪问答 Pro Max</a></li><li><a href=#%e5%8d%96%e7%93%9c class=nav-卖瓜>卖瓜</a></li><li><a href=#%e9%80%8f%e6%98%8e%e7%9a%84%e6%96%87%e4%bb%b6 class=nav-透明的文件>透明的文件</a></li><li><a href=#%e6%97%85%e8%a1%8c%e7%85%a7%e7%89%87 class=nav-旅行照片>旅行照片</a></li><li><a href=#flag-%e5%8a%a9%e5%8a%9b%e5%a4%a7%e7%ba%a2%e5%8c%85 class=nav-flag-助力大红包>FLAG 助力大红包</a></li><li><a href=#amnesia class=nav-amnesia>Amnesia</a></li><li><a href=#%e5%9b%be%e4%b9%8b%e4%b8%8a%e7%9a%84%e4%bf%a1%e6%81%af class=nav-图之上的信息>图之上的信息</a></li><li><a href=#easy-rsa class=nav-easy-rsa>Easy RSA</a></li><li><a href=#%e5%8a%a0%e5%af%86%e7%9a%84-u-%e7%9b%98 class=nav-加密的-u-盘>加密的 U 盘</a></li><li><a href=#%e8%b5%9b%e5%8d%9a%e5%8e%a8%e6%88%bf class=nav-赛博厨房>赛博厨房</a></li><li><a href=#%e9%98%b5%e5%88%97%e6%81%a2%e5%a4%8d%e5%a4%a7%e5%b8%88 class=nav-阵列恢复大师>阵列恢复大师</a></li><li><a href=#%e9%a9%ac%e8%b5%9b%e5%85%8b class=nav-马赛克>马赛克</a></li><li><a href=#minecraft class=nav-minecraft>minecRaft</a></li><li><a href=#%e5%85%b6%e4%bb%96 class=nav-其他>其他</a></li></ul></div></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div id=single-column-footer><a href=https://github.com/cjc7373/hugo-theme-diary>Modified</a> Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Coherence. 本站遵循 CC BY-NC-SA 4.0 协议</div></div><script src=/js/journal.js></script></body></html>