<!doctype html><html><head><title>使用KMS激活Visio</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content="3MbbliKSwhNvv713tGB2RL8xvrJC404x1BFONabsw7g"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/scss/journal.min.0f46f98b723f2aad4b02d9370bb6aa7848b5c2b2a5579642014082283683d2d8.css integrity="sha256-D0b5i3I/Kq1LAtk3C7aqeEi1wrKlV5ZCAUCCKDaD0tg=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.79c34391dbcff20df8b4dac718e2606701efcbfdb9f3b08447ac39ac9dc7b463.css integrity="sha256-ecNDkdvP8g34tNrHGOJgZwHvy/2587CER6w5rJ3HtGM=" media=screen><script src=/js/toc.js></script>
<link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Material+Icons"><script async defer data-domain=blog.coherence.codes src=https://analytics.coherence.space/js/plausible.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></head><body><div id=app><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://blog.coherence.codes/><div class=nav-title>Coherence's Blog</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>存档</a>
<a class="a-block nav-link-item false" href=/tags>标签</a>
<a class="a-block nav-link-item false" href=/categories>分类</a>
<a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a></div><div class=nav-footer><a href=https://github.com/cjc7373/hugo-theme-diary>Modified</a> Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
2022 Coherence's Blog</div></div><div id=extraContainer class=extra-container><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc-content><center>- 目录 -</center><ul><ul><li><a href=#%e9%a2%98%e8%ae%b0 onclick="onNavClick(`#题记-nav`)" id=题记-nav>题记</a></li><li><a href=#%e8%bd%ac%e6%8d%a2visio%e7%89%88%e6%9c%ac onclick="onNavClick(`#转换visio版本-nav`)" id=转换visio版本-nav>转换Visio版本</a></li><li><a href=#%e8%ae%be%e7%bd%aekms%e5%af%86%e9%92%a5%e5%8f%8a%e6%9c%8d%e5%8a%a1%e5%99%a8 onclick="onNavClick(`#设置kms密钥及服务器-nav`)" id=设置kms密钥及服务器-nav>设置KMS密钥及服务器</a></li><li><a href=#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99 onclick="onNavClick(`#参考资料-nav`)" id=参考资料-nav>参考资料</a></li></ul></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>存档</a>
<a class="a-block drawer-menu-item false" href=/tags>标签</a>
<a class="a-block drawer-menu-item false" href=/categories>分类</a>
<a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a><div class=toc><div class=toc-content><center>- 目录 -</center><ul><ul><li><a href=#%e9%a2%98%e8%ae%b0 onclick="onNavClick(`#题记-nav`)" id=题记-nav>题记</a></li><li><a href=#%e8%bd%ac%e6%8d%a2visio%e7%89%88%e6%9c%ac onclick="onNavClick(`#转换visio版本-nav`)" id=转换visio版本-nav>转换Visio版本</a></li><li><a href=#%e8%ae%be%e7%bd%aekms%e5%af%86%e9%92%a5%e5%8f%8a%e6%9c%8d%e5%8a%a1%e5%99%a8 onclick="onNavClick(`#设置kms密钥及服务器-nav`)" id=设置kms密钥及服务器-nav>设置KMS密钥及服务器</a></li><li><a href=#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99 onclick="onNavClick(`#参考资料-nav`)" id=参考资料-nav>参考资料</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://blog.coherence.codes/>Coherence's Blog</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://blog.coherence.codes/><div class=single-column-header-title>Coherence's Blog</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>使用KMS激活Visio<div class=post-meta><time itemprop=datePublished>2018-12-01 23:11</time>
<i class=material-icons>label</i>
<a href=/tags/kms>KMS</a>
&nbsp;
<a href=/tags/office>Office</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><h2 id=题记>题记</h2><p>如果你懒的话当然可以用KMSpico等工具一键激活，但博主不想电脑里多个启动项，并且博主的电脑预装了Office2013家庭与学生版，用此类工具可能出现不可预知的后果，所以打算自己动手激活Visio。</p><h2 id=转换visio版本>转换Visio版本</h2><p>我在<a href="http://msdn.itellyou.cn/?lang=zh-cn">MSDN我告诉你</a>和某非著名PT站上并没有找到Visio的VL（批量授权）版本，然而KMS激活需要VL版，所以第一步是转换Visio的版本。</p><p>复制以下代码，保存为.bat文件并用管理员身份运行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#66d9ef>if</span> exist <span style=color:#e6db74>&#34;%ProgramFiles%\Microsoft Office\Office16\ospp.vbs&#34;</span> cd /d <span style=color:#e6db74>&#34;%ProgramFiles%\Microsoft Office\Office16&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> exist <span style=color:#e6db74>&#34;%ProgramFiles(x86)%\Microsoft Office\Office16\ospp.vbs&#34;</span> cd /d <span style=color:#e6db74>&#34;%ProgramFiles(x86)%\Microsoft Office\Office16&#34;</span>
</span></span><span style=display:flex><span>cscript ospp.vbs /rearm
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> /f %%x in <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;dir /b ..\root\Licenses16\visio???vl_kms*.xrm-ms&#39;</span><span style=color:#f92672>)</span> <span style=color:#66d9ef>do</span> cscript ospp.vbs /inslic:<span style=color:#e6db74>&#34;..\root\Licenses16\%%x&#34;</span> &gt;nul
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> /f %%x in <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;dir /b ..\root\Licenses16\visio???vl_mak*.xrm-ms&#39;</span><span style=color:#f92672>)</span> <span style=color:#66d9ef>do</span> cscript ospp.vbs /inslic:<span style=color:#e6db74>&#34;..\root\Licenses16\%%x&#34;</span> &gt;nul
</span></span></code></pre></div><p>以上命令的作用分别为：</p><ul><li>打开Office的安装目录（Visio也属于Office的一部分）</li><li>重置零售激活</li><li>安装KMS和MAK许可证（转换版本）</li></ul><p>题外话：转换Office和Project版本同理。</p><p>Office：</p><pre tabindex=0><code>cscript ospp.vbs /rearm
for /f %%x in (&#39;dir /b ..\root\Licenses16\proplusvl_kms*.xrm-ms&#39;) do cscript ospp.vbs /inslic:&#34;..\root\Licenses16\%%x&#34; &gt;nul
for /f %%x in (&#39;dir /b ..\root\Licenses16\proplusvl_mak*.xrm-ms&#39;) do cscript ospp.vbs /inslic:&#34;..\root\Licenses16\%%x&#34; &gt;nul
</code></pre><p>Project：</p><pre tabindex=0><code>cscript ospp.vbs /rearm
for /f %%x in (&#39;dir /b ..\root\Licenses16\project???vl_kms*.xrm-ms&#39;) do cscript ospp.vbs /inslic:&#34;..\root\Licenses16\%%x&#34; &gt;nul
for /f %%x in (&#39;dir /b ..\root\Licenses16\project???vl_mak*.xrm-ms&#39;) do cscript ospp.vbs /inslic:&#34;..\root\Licenses16\%%x&#34; &gt;nul
</code></pre><p>再跑下题，为什么要用批处理呢，因为这段命令直接在cmd里执行会出错，博主没学过Shell无法理解。（留下了没有知识的泪水）</p><h2 id=设置kms密钥及服务器>设置KMS密钥及服务器</h2><p>打开Office的安装目录，也就是代码里的<code>%ProgramFiles%\Microsoft Office\Office16\</code>（64位）或者<code>%ProgramFiles(x86)%\Microsoft Office\Office16\</code>（32位）。</p><p>按住Shift+右键，选择在此处打开PowerShell，输入：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>cscript ospp.vbs /inpkey<span style=color:#960050;background-color:#1e0010>:</span>PD3PC-RHNGV-FXJ29-8JK7D-RJRJK
</span></span></code></pre></div><p>来安装KMS密钥。注意以上命令中的KMS密钥只适用与Visio2016，其他版本可到<a href=https://docs.microsoft.com/zh-cn/DeployOffice/vlactivation/gvlks>微软官方文档</a>中查询。</p><p>然后设置KMS服务器，博主用的是网上找的，以后尝试一下自己搭一个：</p><pre tabindex=0><code>cscript ospp.vbs /sethst:xxx.xxx
</code></pre><p>由于不保证可用性，服务器名称已略去。</p><p>指令Office立即连接KMS服务器进行激活：</p><pre tabindex=0><code>cscript ospp.vbs /act
</code></pre><p>完成！</p><h2 id=参考资料>参考资料</h2><p><a href=https://03k.org/kms.html>https://03k.org/kms.htm</a></p><p><a href=https://segmentfault.com/a/1190000015697457>https://segmentfault.com/a/1190000015697457</a></p><p><a href=https://blog.csdn.net/ywd1992/article/details/79412991>https://blog.csdn.net/ywd1992/article/details/79412991</a></p><hr width=100% id=EOF><p style=color:#777>最后修改于 2018-12-01</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2020_and_before/domjudge-config/>下回<br>DOMjudge 配置/踩坑指南</a>
<a class=older-posts href=/posts/2020_and_before/all-about-markdown/>上回<br>Markdown简介</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=single-column-footer><a href=https://github.com/cjc7373/hugo-theme-diary>Modified</a> Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
2022 Coherence's Blog</div></div><script src=/js/journal.js></script></body></html>